# -*- mode:python -*-

Import('*')

import os

mesa_root = os.environ['GPGPUSIM_MESA_ROOT']

env.Append(CXXFLAGS =['-I'+mesa_root+'/Mesa-7.11.2_GPGPU-Sim/src/mesa',
		     '-I'+mesa_root+'/Mesa-7.11.2_GPGPU-Sim/src/mapi',
	             '-I'+mesa_root+'/Mesa-7.11.2_GPGPU-Sim/src/mesa/swrast',
		     '-I'+mesa_root+'/src',
		     '-I'+mesa_root+'/gem5-gpu/src',
 		     '-D_POSIX_SOURCE', '-D_SVID_SOURCE', '-D_BSD_SOURCE',
                     '-D_GNU_SOURCE', '-DPTHREADS', '-DUSE_XSHM', '-DHAVE_POSIX_MEMALIGN']) 

env.Append(LIBS = 'GL', LIBPATH=mesa_root+'/Mesa-7.11.2_GPGPU-Sim/lib64')		   
Source('gpgpusim_calls.cpp')
Source('mesa_gpgpusim.cpp', Werror=False)
Source('mesa_calls.cpp', Werror=False)
Source('graphics_syscall_helper.cc')
Source('graphic_calls.cc')
Source('libOpenglRender/dll.cc')
Source('libOpenglRender/socket_local_server.c')
Source('libOpenglRender/socket_local_client.c')
Source('libOpenglRender/SocketStream.cc')
Source('libOpenglRender/UnixStream.cc')
Source('graphicsStream.cc')
Source('serialize_graphics.cc', Werror=False)
Source('gem5_graphics_calls.cc')
Source('fixed_pipeline.cc', Werror=False)

DebugFlag("GraphicsCalls")
DebugFlag('MesaGpgpusim')
